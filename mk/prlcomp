#
# This function computes the result of the prlc command.
# This duplicates the funcationality in filter/filter/prlcomp.ml
#

Shell. +=
   prlcomp(argv) =
      setenv (MP_ROOT, $(ROOT))
      setenv (MPLIB, $(LIB))
      setenv (MP_GROUP, $(THEORYNAME))
      setenv (MP_DESCR, $(THEORYDESCR))
      setenv (MP_INCLUDE, $(concat :, $(OCAMLINCLUDES)))
      code=$(shell-code $(argv))
      if $(eq $(code), 0)
         return 1
      else
         exit $(code)

#
# Command without a preprocessor
#
WrapC(command) =
   #
   # Put together the command
   #
   COMMAND = prlcomp $(command) -I $(LIB)

   return($(COMMAND))

#
# Command with a preprocessor
#
PrlC(command) =
   #
   # Put together the command
   # JYH: not sure if this should be hardcoded as CAMLP4N.
   #
   COMMAND[] = prlcomp $(command) -I $(LIB) -pp $(quote-argv $(CAMLP4N) $(LOC))

   return($(COMMAND))
