#
# Don't try to scan files in this directory.
# List the dependencies explicitly.
#
.SCANNER: scan-ocaml-%.mli scan-ocaml-%.ml:
    @

OCAMLDEP = $(file ocamldep$(EXE))
BINDEP   = $(file $(BIN)/ocamldep$(EXE))

#
# We also use our own version of ocamldep
#
OCamlProgramInstall($(MPINSTALL), $(BIN), ocamldep, ocamldep)

ocamldep$(EXT_OBJ) ocamldep.cmx ocamldep.cmo ocamldep.cmi:

#
# Phony targets
#
clean:
    $(CLEAN) *.cm* *~ ocamldep.ml *.o *.exe Makefile.dep ocamldep ocamldep.opt ocamldep.run macropp macroprint

#
# Macros
#
OCAML_LIBS += $(CAMLP4LIB)/odyl $(CAMLP4LIB)/camlp4
OCAMLINCLUDES += $(CAMLP4LIB)
OCAML_LINK_FLAGS += -linkall
OCAMLFLAGS += -pp $(quote-argv $(CAMLP4R) -I $(CAMLP4LIB) -nolib $(LOC))

%.cmx %$(EXT_OBJ): $(CAMLP4R_VERSION)
%.cmo: $(CAMLP4R_VERSION)
%.cmi: $(CAMLP4R_VERSION)

MACRO_FILES[] =
    $(CAMLP4LIB)/pa_o
    pa_macro
    macro_main

OCamlProgramInstall($(MPINSTALL), $(LIB), macropp, $(CAMLP4LIB)/pr_dump $(MACRO_FILES))
OCamlProgramInstall($(MPINSTALL), $(LIB), macroprint, $(CAMLP4LIB)/pr_o $(MACRO_FILES))
